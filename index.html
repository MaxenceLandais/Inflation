<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Inflation Live - Indice 100</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; max-width: 900px; margin: auto; padding: 40px; background: #f0f2f5; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        h1 { color: #1a2a6c; text-align: center; margin-bottom: 10px; }
        p.subtitle { text-align: center; color: #666; margin-bottom: 30px; }
    </style>
</head>
<body>
    <h1>ðŸ“ˆ Mon Indice de l'Inflation</h1>
    <p class="subtitle">Base 100 fixÃ©e au premier relevÃ© (Calcul en temps rÃ©el)</p>
    
    <div class="card">
        <canvas id="inflationChart"></canvas>
    </div>

    <script>
        async function loadData() {
            const response = await fetch('prices_history.json');
            const text = await response.text();
            const data = text.trim().split('\n').map(line => JSON.parse(line));

            const dates = data.map(d => new Date(d.date).toLocaleDateString('fr-FR'));
            
            // Calcul de la somme du panier pour chaque jour
            const dailyTotals = data.map(day => {
                return day.produits.reduce((sum, prod) => sum + prod.prix, 0);
            });

            // Transformation en Base 100
            const firstTotal = dailyTotals[0];
            const base100Data = dailyTotals.map(total => (total / firstTotal) * 100);

            const ctx = document.getElementById('inflationChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Indice des prix (Base 100)',
                        data: base100Data,
                        borderColor: '#1a2a6c',
                        backgroundColor: 'rgba(26, 42, 108, 0.1)',
                        fill: true,
                        tension: 0.3,
                        borderWidth: 3
                    }]
                },
                options: {
                    plugins: {
                        legend: { display: true }
                    },
                    scales: {
                        y: { min: 95, max: 105 } // Zoom sur les variations
                    }
                }
            });
        }
        loadData();
    </script>
</body>
</html>
